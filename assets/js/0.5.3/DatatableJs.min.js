+function(t,e){"use strict";var o={};o.log_levels=["trace","debug","info","warn","error","off"],o.log_level=o.log_levels.indexOf("info"),o.console=t.console,o.console||(o.console={}),o.console.assert||(o.console.assert=function(){}),o.console.count||(o.console.count=function(){}),o.console.dir||(o.console.dir=function(){}),o.console.error||(o.console.error=function(){}),o.console.group||(o.console.group=function(){}),o.console.groupCollapsed||(o.console.groupCollapsed=function(){}),o.console.groupEnd||(o.console.groupEnd=function(){}),o.console.info||(o.console.info=function(){}),o.console.log||(o.console.log=function(){}),o.console.time||(o.console.time=function(){}),o.console.timeEnd||(o.console.timeEnd=function(){}),o.console.trace||(o.console.trace=function(){}),o.console.warn||(o.console.warn=function(){}),o.console_levels={},o.console_levels.assert=0,o.console_levels.count=0,o.console_levels.dir=0,o.console_levels.error=4,o.console_levels.group=2,o.console_levels.groupCollapsed=2,o.console_levels.groupEnd=2,o.console_levels.info=2,o.console_levels.log=1,o.console_levels.time=1,o.console_levels.timeEnd=1,o.console_levels.trace=0,o.console_levels.warn=3,o.getLogLevel=function(){return e===o.log_levels[Number(o.log_level)]&&o.setLogLevel("info"),o.log_levels[o.log_level]},o.setLogLevel=function(t){if(-1===o.log_levels.indexOf(t))throw new i.lib.Exception("Invalid log level: "+t);o.log_level=o.log_levels.indexOf(t),o.buildLogger()},o.buildLogger=function(){t.DatatableJs.console={};for(var e in o.console_levels)o.console_levels.hasOwnProperty(e)&&(o.console_levels[e]>=o.log_levels.indexOf(this.getLogLevel())?t.DatatableJs.console[e]=function(){return o.console[e].apply(o.console,arguments)}:t.DatatableJs.console[e]=function(){});return t.DatatableJs.console};var i=function(t){this._data=e,this._schema=e,this.init(t)};i.lib={Column:e,Schema:e,Data:e,Iterator:e,Exception:e},i.prototype.lib=i.lib,i.prototype._is_shadow=!1,i.prototype.init=function(t){return t&&(e!==t.schema&&this.setSchema(t.schema),e!==t.data&&this.setData(t.data),e!==t.log_level&&this.setLogLevel(t.log_level)),this},i.prototype.clone=function(){var e=t.JSON.parse(t.JSON.stringify(this.getRows()));return new i({data:e,schema:this.getSchema()}).isShadow(this.isShadow())},i.prototype.getData=function(){return this._data instanceof this.lib.Data||(this._data=new this.lib.Data,this._data.setSchema(this.getSchema()),this._data.isShadow(this.isShadow())),this._data},i.prototype.setData=function(t){if(e!==t){if(t instanceof Array){var o=t;t=new this.lib.Data,t.setSchema(this.getSchema()),t.setRows(o),t.isShadow(this.isShadow())}else if(!(t instanceof i.lib.Data))throw new i.lib.Exception("The data definition must be an array of data rows or an instance of DatatableJs.lib.Data");this._data=t}return this},i.prototype.getLogLevel=function(){return o.getLogLevel()},i.prototype.setLogLevel=function(t){return o.setLogLevel(t),this},i.prototype.addRow=function(t){return this.getData().addRow(t)},i.prototype.getRows=function(){return this.getData().getRows()},i.prototype.getRow=function(t){var e=this.createIterator();for(var o in t)t.hasOwnProperty(o)&&t[o]&&e.addFilterRule({fields:o,comparators:"==",values:t[o]});return e.next()},i.prototype.setRows=function(t){if(!(t instanceof Array))throw new i.lib.Exception("The data definition must be an array of data rows");return this.getData().setRows(t),this},i.prototype.getSchema=function(){return this._schema instanceof this.lib.Schema||(this._schema=new this.lib.Schema),this._schema},i.prototype.setSchema=function(t){return e!==t&&("object"!=typeof t||t instanceof i.lib.Schema||(t=new this.lib.Schema(t)),this._schema=t,this._data instanceof i.lib.Data&&this._data.setSchema(t)),this},i.prototype.createIterator=function(){return new this.lib.Iterator(this)},i.prototype.splice=function(t){if(!(t instanceof this.lib.Iterator))throw new i.lib.Exception("Splicing the data requires an Iterator for filtering");for(t.execute();t.next();)t.remove();return this.getData().indexRows(),this},i.prototype.isShadow=function(t){var e;return"undefined"!=typeof t?(this._is_shadow=Boolean(t),this._data instanceof this.lib.Data&&this._data.isShadow(this._is_shadow),e=this):e=this._is_shadow,e},t.DatatableJs=i,o.buildLogger()}(this),+function(t,e){"use strict";var o=function(t,e,o){this.message=t,this.fileName=e,this.lineNumber=o};o.prototype=Error.prototype,o.prototype.constructor=o,o.prototype.name="DatatableJs.Exception",t.DatatableJs.lib.Exception=o}(this),+function(t,e){"use strict";var o=function(t){this._columns={},this.init(t)};o.prototype.init=function(t){return t&&this.setColumns(t),this},o.prototype.getColumns=function(){return this._columns},o.prototype.setColumns=function(e){if("object"!=typeof e)throw new t.DatatableJs.lib.Exception("The schema definition must be passed as simple object");this._columns={};for(var o in e)e.hasOwnProperty(o)&&(e[o]instanceof t.DatatableJs.lib.Column?this._columns[o]=e[o]:this._columns[o]=new t.DatatableJs.lib.Column(e[o]));return this},o.prototype.getColumn=function(o){if(e!==this._columns[o]&&!(this._columns[o]instanceof t.DatatableJs.lib.Column))throw new t.DatatableJs.lib.Exception('The column "'+o+'" has an invalid definition');return this._columns[o]},o.prototype.deleteColumn=function(t){return e!==this._columns[t]&&delete this._columns[t],this},o.prototype.setColumn=function(e,o){if(!e)throw new t.DatatableJs.lib.Exception('Invalid column name: "'+e+'"');if("string"!=typeof e)throw new t.DatatableJs.lib.Exception("The column name must be a string");return o instanceof t.DatatableJs.lib.Column||(o=new t.DatatableJs.lib.Column(o)),this._columns[e]=o,this},o.prototype.isValidRow=function(e){var o=!0,i=this.getColumns();for(var s in i)if(i.hasOwnProperty(s)&&(o=this.isValidData(s,e[s]),!o)){t.DatatableJs.console.error('DatatableJs.lib.Schema: "'+s+'" value is invalid',e[s],i[s].getDefinition());break}return o},o.prototype.isValidData=function(t,o){var i=function(t){var e="";return e=null===t?"Null":{}.toString.call(t).replace(/[\[\]]/g,"").split(" ")[1],"Number"===e&&isNaN(t)&&(e="NaN"),e},s=!0,n=this.getColumn(t);return!1!==n.get("nullable")||"undefined"!=typeof o&&null!==o&&""!==o||(s=!1),s&&null!==o&&e!==o&&""!==o&&e!==n.get("type")&&(s=i(o)===n.get("type")||"Function"===i(n.get("type"))&&i(o)===n.get("type").name||"Function"===i(n.get("type"))&&o instanceof n.get("type")),s},t.DatatableJs.lib.Schema=o}(this),+function(t,e){"use strict";var o=function(t){return this._column_definition={},this.init(t),this};o.prototype.init=function(t){return this.setDefinition(t)},o.prototype.get=function(t){return this.getDefinition()[t]},o.prototype.set=function(t,e){return this.getDefinition()[t]=e,this},o.prototype.getDefinition=function(){return this._column_definition},o.prototype.setDefinition=function(o){if(e===o&&(o={}),"object"!=typeof o)throw new t.DatatableJs.lib.Exception("Column definitions must be passed as an object");for(var i in o)o.hasOwnProperty(i)&&(this._column_definition[i]=o[i]);return this},t.DatatableJs.lib.Column=o}(this),+function(t,e){"use strict";var o=function(t){this._current_sort_column=e,this._current_sort_direction=e,this._rows=[],this._schema=e,this.init(t)};o.prototype._is_shadow=!1,o.prototype.init=function(t){return e!==t&&this.setRows(t),this},o.prototype.getRows=function(){return this._rows instanceof Array||(this._rows=[]),this._rows},o.prototype.setRows=function(o){if(!(o instanceof Array))throw new t.DatatableJs.lib.Exception("Data must be an array objects representing rows");this.truncate(),this._current_sort_column=e,this._current_sort_direction=e;var i;for(i=0;i<o.length;i++)this.addRow(o[i]);return 0===i&&t.DatatableJs.console.info("DatatableJs - No data rows found"),0===this.getRows().length&&i>0&&t.DatatableJs.console.info("DatatableJs - No valid data rows found"),this.getRows().length<i&&t.DatatableJs.console.info("DatatableJs - "+(i-this.getRows().length)+" of "+i+" data rows were invalid"),this},o.prototype.addRow=function(e){if("object"!=typeof e)throw new t.DatatableJs.lib.Exception("Row data must be a simple object");0===Object.keys(e).length&&t.DatatableJs.console.warn("DatatableJs - An attempt to insert an empty data row rejected");var o=!0;if(this.getSchema()instanceof t.DatatableJs.lib.Schema&&(o=this.getSchema().isValidRow(e)),o){if(!e.hasOwnProperty("__pos__")){var i;Object.defineProperty(e,"__pos__",{get:function(){return i},set:function(t){i=t}})}this.isShadow()||(e.__pos__=this._rows.length),this._rows.push(e)}return this},o.prototype.getSchema=function(){return this._schema instanceof t.DatatableJs.lib.Schema||(this._schema=new t.DatatableJs.lib.Schema),this._schema},o.prototype.setSchema=function(e){if(!(e instanceof t.DatatableJs.lib.Schema))throw new t.DatatableJs.lib.Exception('"schema" must be an instance of DatatableJs.lib.Schema');var o=this.getRows();return this.truncate(),this._schema=e,o.length&&this.setRows(o),this},o.prototype.sort=function(o,i,s,n){if(e===o&&(o=this._current_sort_column),"string"!=typeof o)throw new t.DatatableJs.lib.Exception("Invalid column value: "+o);var a=!1;return"string"!=typeof i&&o===this._current_sort_column&&(i="asc"===this._current_sort_direction?"desc":"asc",this._current_sort_column=o,this._current_sort_direction=i,a=!0),a?(this._rows.reverse(),this.indexRows()):("function"!=typeof n&&(n=e),"function"!=typeof s&&(s=function(t,o){var i;return i=e===t||null===t?-1:e===o||null===o?1:o>t?-1:t>o?1:0}),this.getSchema()instanceof t.DatatableJs.lib.Schema&&this.getSchema().getColumn(o)instanceof t.DatatableJs.lib.Column&&("function"==typeof this.getSchema().getColumn(o).get("sort_transformer")&&(n=this.getSchema().getColumn(o).get("sort_transformer")),"function"==typeof this.getSchema().getColumn(o).get("sort_comparator")&&(s=this.getSchema().getColumn(o).get("sort_comparator")),"string"!=typeof i&&this.getSchema().getColumn(o).get("sort_direction")&&(i="desc"===this.getSchema().getColumn(o).get("sort_direction")?"desc":"asc")),"string"!=typeof i&&(i="asc"),this._rows.sort(function(t,a){var r=0,l=t[o],c=a[o];return e!==n&&(l=n(l),c=n(c)),r=e!==l&&null!==l&&""!==l||l===c?e!==c&&null!==c&&""!==c||l===c?l===c?"asc"===i?t.__pos__-a.__pos__:a.__pos__-t.__pos__:s(l,c):-1:1}),"desc"===i&&this._rows.reverse(),this.indexRows(),this._current_sort_column=o,this._current_sort_direction=i),this},o.prototype.indexRows=function(){for(var t=0;t<this._rows.length;t++)this._rows[t].__pos__=t;return this},o.prototype.truncate=function(){return this._current_sort_column=e,this._current_sort_direction=e,this._rows=[],this},Object.defineProperty(o.prototype,"length",{set:function(){throw new t.DatatableJs.lib.Exception("Cannot redefine property: length")},get:function(){return this._rows.length}}),o.prototype.isShadow=function(t){var e;return"undefined"!=typeof t?(this._is_shadow=Boolean(t),e=this):e=this._is_shadow,e},t.DatatableJs.lib.Data=o}(this),+function(t,e){"use strict";var o={enabled:!1,rows_per_page:25,current_page:1},i=function(i){if(!(i instanceof t.DatatableJs))throw new t.DatatableJs.lib.Exception("Iterator constructor requres a DatatableJs reference");this.datatable_instance=i,this.shadow_instance=new t.DatatableJs,this.shadow_instance.setSchema(this.datatable_instance.getSchema()),this.shadow_instance.isShadow(!0),this.shadow_index=[],this._cur_value=e,this._filters=[],this._is_executed=!1,this._is_filtered=!1,this._is_sorted=!1,this._iterator_key=-1,this._iterator_value=e,this._pagination={enabled:o.enabled,rows_per_page:o.rows_per_page,current_page:o.current_page},this._schema=e,this._sorts=[]};i.prototype.getData=function(){return this.applyFilterRules(),this.shadow_instance.getData()},i.prototype.getRows=function(){return this.applyFilterRules(),this.shadow_instance.getRows()},i.prototype.getSchema=function(){return this.datatable_instance.getSchema()},i.prototype.addFilterRule=function(e){if(!(e&&e.fields&&e.comparators&&e.values))throw new t.DatatableJs.lib.Exception("An invalid filter definition was rejected",e);return e.fields instanceof Array||(e.fields=[e.fields]),e.comparators instanceof Array||(e.comparators=[e.comparators]),e.values instanceof Array||(e.values=[e.values]),this._filters.push({fields:e.fields,comparators:e.comparators,values:e.values}),this._is_filtered=!1,this},i.prototype.clearFilterRules=function(){return this._filters=[],this._is_filtered=!1,this},i.prototype.setFilterRules=function(e){if(!(e instanceof Array))throw new t.DatatableJs.lib.Exception("Filter rules must be an array of valid rule definition objects");this.clearFilterRules();for(var o=0;o<e.length;o++)this.addFilterRule(e[o]);return this},i.prototype.getFilterRules=function(){return this._filters},i.prototype.addSortRule=function(o){if(!(o&&o.column&&o.column+""))throw new t.DatatableJs.lib.Exception("An invalid sort definition was rejected",o);return this._sorts.push({column:o.column+"",direction:o.direction?o.direction:e,comparator:o.comparator?o.comparator:e,transformer:o.transformer?o.transformer:e}),this._is_sorted=!1,this},i.prototype.clearSortRules=function(){return this._sorts=[],this._is_sorted=!1,this},i.prototype.getSortRules=function(){return this._sorts},i.prototype.setSortRules=function(e){if(!(e instanceof Array))throw new t.DatatableJs.lib.Exception("Sort rules must be an array of valid rule definition objects");this.clearSortRules();for(var o=0;o<e.length;o++)this.addSortRule(e[o]);return this},i.prototype.setPaginationRule=function(i){if(e===i||e===i.enabled&&e===i.rows_per_page&&e===i.current_page)throw new t.DatatableJs.lib.Exception("An invalid pagination rule was rejected",i);return i.enabled||(i.enabled=this._pagination.enabled?this._pagination.enabled:o.enabled),i.rows_per_page||(i.rows_per_page=this._pagination.rows_per_page?this._pagination.rows_per_page:o.rows_per_page),i.current_page||(i.current_page=this._pagination.current_page?this._pagination.current_page:o.current_page),i.enabled=!0===i.enabled,i.rows_per_page=Math.round(Number(i.rows_per_page)),i.current_page=Math.round(Number(i.current_page)),this._pagination.enabled=i.enabled,this._pagination.rows_per_page=i.rows_per_page,this._pagination.current_page=i.current_page,this},i.prototype.getPage=function(){return Number(this._pagination.current_page)},i.prototype.setPage=function(e){if(!e)throw new t.DatatableJs.lib.Exception('Invalid page number "'+e+'"');return this._pagination.current_page=Math.round(Number(e)),this},i.prototype.getRowsPerPage=function(){return this._pagination.rows_per_page},i.prototype.setRowsPerPage=function(e){if(!e)throw new t.DatatableJs.lib.Exception('Invalid page size "'+e+'"');return this._pagination.rows_per_page=Math.round(Number(e)),this._pagination.current_page=1,this},i.prototype.getPaginationEnabled=function(){return this._pagination.enabled===!0},i.prototype.setPaginationEnabled=function(t){return this._pagination.enabled=!0===t,this},i.prototype.execute=function(t){return t&&t.page&&(this.setPaginationEnabled(!0),this.setPage(Number(t.page))),this._iterator_key=this.getMinRow()-1,this._iterator_value=e,this.applyFilterRules(),this.applySortRules(),this._is_executed=!0,this},i.prototype.applyFilterRules=function(){if(!this._is_filtered){this.shadow_instance.getData().truncate(),this.shadow_index=[];for(var t=0;t<this.datatable_instance.getRows().length;t++)this.datatable_instance.getRows()[t]&&this.rowMatches(this.datatable_instance.getRows()[t])&&(this.shadow_instance.addRow(this.datatable_instance.getRows()[t]),this.shadow_index.push(this.datatable_instance.getRows()[t].__pos__));this._is_filtered=!0}return this},i.prototype.applySortRules=function(){if(!this._is_sorted){if(0<this._sorts.length)for(var t=0;t<this._sorts.length;t++)this.datatable_instance.getData().sort(this._sorts[t].column,this._sorts[t].direction,this._sorts[t].comparator,this._sorts[t].transformer);this.shadow_instance.getData().sort("__pos__","asc"),this._is_sorted=!0}return this},i.prototype.sort=function(){return this._is_sorted?(this.datatable_instance.getData().sort(),this.shadow_instance.getData().sort()):this.applySortRules(),this},i.prototype.getMinRow=function(){var t=0;return this._pagination.enabled&&(t=this._pagination.current_page*this._pagination.rows_per_page-this._pagination.rows_per_page),t},i.prototype.getMaxRow=function(){var t=this.getRows().length;return this._pagination.enabled&&(t=this._pagination.current_page*this._pagination.rows_per_page-1),t},i.prototype.next=function(){return this._is_executed||this.execute(),this._iterator_key<=this.getMaxRow()&&this._iterator_key++,this._iterator_value=e,this._iterator_key>=this.getMinRow()&&this._iterator_key<=this.getMaxRow()&&this.getRows()[this._iterator_key]&&(this._iterator_value=this.getRows()[this._iterator_key]),this._iterator_value},i.prototype.curr=function(){if(!this._is_executed)throw new t.DatatableJs.lib.Exception("Iterators must be executed before they can be iterated");return this._iterator_value},i.prototype.prev=function(){if(this._iterator_key>=this.getMinRow()&&this._iterator_key--,!this._is_executed)throw new t.DatatableJs.lib.Exception("Iterators must be executed before they can be iterated");return this._iterator_value=e,this._iterator_key>=this.getMinRow()&&this._iterator_key<=this.getMaxRow()&&this.getRows()[this._iterator_key]&&(this._iterator_value=this.getRows()[this._iterator_key]),this._iterator_value},i.prototype.remove=function(){for(this.datatable_instance.getRows().splice(this.shadow_index[this._iterator_key],1),this.getRows().splice(this._iterator_key,1),this.shadow_index.splice(this._iterator_key,1);this._iterator_key>this.getRows().length;)this._iterator_key--;return this.datatable_instance.getData().indexRows(),this._iterator_value=this.getRows()[this._iterator_key],this._cur_value=this.getRows()[this._iterator_key],this},i.prototype.rowMatches=function(t){for(var o=!0,i=0;i<this._filters.length;i++){var s=!1,n=this._filters[i];n.fields instanceof Array||(n.fields=[n.fields]),n.comparators instanceof Array||(n.comparators=[n.comparators]),n.values instanceof Array||(n.values=[n.values]);for(var a=0;a<n.fields.length;a++){var r=n.fields[a];if(s=e===t[r]?!1:this._compare(t[r],n.comparators,n.values))break}if(o=s,!o)break}return o},i.prototype._compare=function(t,e,o){for(var i=!1,s=0;s<e.length;s++){for(var n=0;n<o.length;n++){if("function"==typeof e[s])i=e[s](t,o[n]);else switch(e[s]){case">":i=t>o[n];break;case">=":i=t>=o[n];break;case"<":i=t<o[n];break;case"<=":i=t<=o[n];break;case"==":i=t==o[n];break;case"===":i=t===o[n];break;case"!=":i=t!=o[n];break;case"!==":i=t!==o[n]}if(i)break}if(i)break}return i},i.prototype.reset=function(){this.clearFilterRules().clearSortRules().execute(),this._is_executed=!1},i.prototype.where=function(t,e,o){return this.addFilterRule({fields:t,comparators:e,values:o})},i.prototype.and=function(t,e,o){return this.where(t,e,o)},i.prototype.orderBy=function(t,e,o,i){return this.addSortRule({column:t,direction:e,comparator:o,transformer:i})},Object.defineProperty(i.prototype,"length",{set:function(){throw new t.DatatableJs.lib.Exception("Cannot redefine property: length")},get:function(){return this.applyFilterRules(),this.shadow_instance.getRows().length}}),i.prototype["export"]=function(e,o){var i,s,n,a,r,l,c,h,u=this,p=[],_=[],f=u.applyFilterRules().getRows(),g=[],d=this.datatable_instance.getSchema().getColumns();if(!Object.keys(d).length)throw new t.DatatableJs.lib.Exception("A data schema is required for exports");switch(o||(o="export"),String(e).toLowerCase()){default:case"csv":e="csv",i=",",h="text/csv";break;case"tdt":case"tsv":case"txt":i="	",h="text/tab-separated-values"}for(s in d)d.hasOwnProperty(s)&&_.push(s);for(p.push(_),s=0;s<f.length;s++){_=[];for(n in d)d.hasOwnProperty(n)&&(a=f[s][n]instanceof Array?f[s][n].join(","):f[s][n]&&f[s][n].prototype&&Object===f[s][n].prototype?t.JSON.stringify(f[s][n]):f[s][n],a&&(a="csv"===e?a.replace(/,/g,";"):a.replace(/\t/g,"	")),_.push(a));p.push(_)}for(s=0;s<p.length;s++)g.push('"'+p[s].join('"'+i+'"')+'"');return r=new Blob([g.join("\n")],{type:h}),l=window.URL.createObjectURL(r),c=document.createElement("a"),c.href=l,c.setAttribute("download",o+"."+e),document.body.appendChild(c),c.click(),document.body.removeChild(c),u},t.DatatableJs.lib.Iterator=i}(this);
//# sourceMappingURL=DatatableJs.min.js.map
